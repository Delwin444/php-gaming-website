{% extends '@web-interface/base.html.twig' %}

{% block content %}
    <section class="left">
        <div class="box">
            <p>
                <running-games>
                    {{ runningGames.count }}
                </running-games>
                running games
            </p>
        </div>
    </section>
    <section class="middle">
        <ul class="game-list"
            id="games"
            data-open-games="{{ openGames|json_encode|e('html_attr') }}"
            data-maximum-number-of-games="{{ maximumNumberOfGamesInList }}">
        </ul>
    </section>
    <section class="right">
        <div class="box">
            <p>
                <button class="button" data-open-game-button>
                    + Open a new game
                </button>
            </p>
        </div>
    </section>
    <event-source url="/sse/sub?id=lobby"></event-source>
{% endblock %}

{% block javascript %}
    <script type="text/javascript">
        (function () {
            new Gaming.ConnectFour.GameList(
                app.eventPublisher,
                app.gameService,
                document.getElementById('games')
            );
            new Gaming.ConnectFour.OpenGameButton(
                app.eventPublisher,
                app.gameService,
                document.querySelector('[data-open-game-button]')
            );
        })();
    </script>
{% endblock %}
